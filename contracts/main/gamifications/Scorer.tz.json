{
  "text_code":
    "{ parameter (or (nat %buy) (nat %sell)) ;\n  storage\n    (pair (pair (pair (nat %current_rank) (nat %multiplier))\n                (pair (address %owner)\n                      (map %possible_ranks\n                         nat\n                         (or (or (or (unit %bronze) (unit %gold)) (or (unit %osmium) (unit %platnum)))\n                             (unit %silver)))))\n          (pair (pair (nat %score) (address %score_token))\n                (pair (nat %streak) (address %trading_pair)))) ;\n  code { UNPAIR ;\n         IF_LEFT\n           { SWAP ;\n             DUP ;\n             DUG 2 ;\n             CDR ;\n             CDR ;\n             CDR ;\n             CONTRACT %tez_to_token (pair (nat %min_out) (address %receiver)) ;\n             IF_NONE { PUSH string \"Level not found\" ; FAILWITH } {} ;\n             PUSH mutez 1 ;\n             DIG 2 ;\n             MUL ;\n             DUP 3 ;\n             CAR ;\n             CDR ;\n             CAR ;\n             PUSH nat 1 ;\n             PAIR ;\n             TRANSFER_TOKENS ;\n             SWAP ;\n             NIL operation ;\n             DIG 2 ;\n             CONS ;\n             PAIR }\n           { SWAP ;\n             DUP ;\n             DUG 2 ;\n             CDR ;\n             CDR ;\n             CDR ;\n             CONTRACT %token_to_tez (pair (pair (nat %amount) (nat %min_out)) (address %receiver)) ;\n             IF_NONE { PUSH string \"Level not found\" ; FAILWITH } {} ;\n             PUSH mutez 0 ;\n             DUP 4 ;\n             CAR ;\n             CDR ;\n             CAR ;\n             PUSH nat 1 ;\n             DIG 4 ;\n             PAIR ;\n             PAIR ;\n             TRANSFER_TOKENS ;\n             SWAP ;\n             NIL operation ;\n             DIG 2 ;\n             CONS ;\n             PAIR } } }"
}
